shuriken <- c(
                 1, 1, 2, 3, 5, 1, 6, 0, 
                 5, 5, 3, 1, 4, 5, 2, 0, 
                 4, 4, 1, 5, 6, 4, 3, 0, 
                 6, 6, 5, 4, 2, 6, 1, 0, 
                 2, 2, 4, 6, 3, 2, 5, 0, 
                 3, 3, 6, 2, 1, 3, 4, 0
)

next_pair <- function(v) {
  a_new <- (v[1] + shuriken[v[2]] - 1) %% 48 + 1
  b_new <- (v[2] + shuriken[a_new] - 1) %% 48 + 1
  return(c(a_new, b_new))
}

compute_iterates <- function(v, n_its) {
  iterates <- matrix(0, n_its, 2)
  for (i in 1:n_its) {
    iterates[i, ] <- v
    v <- next_pair(v)
  }
  print(dim(unique(iterates))[1])
  iterates[1:dim(unique(iterates))[1],]
}

cycle1 <- compute_iterates(c(1,1), 2000)
cycle2 <- compute_iterates(c(1,2), 2000)
cycle3 <- compute_iterates(c(2,26), 2000)
cycle4 <- compute_iterates(c(3,27), 2000)

plot(cycle1, col = 'gray66')
points(cycle2, col='coral')
points(cycle3, col='blue')
points(cycle4, col='green')


t(cycle3)
#   2    8   14   15   17   20   23   24   25    27    27    31    36    41    44
#  26   26   31   33   37   42   45   45    3     8    13    14    20    23    25

t(cycle4)
#    3    8   13   14   20   23   25   26   26    31    33    37    42    45    45
#   27   27   31   36   41   44    2    8   14    15    17    20    23    24    25



seqz <- shuriken[cycle1[, 1]]
paste0(seqz, collapse='')
# 112133555664130633532565242033401633144636025033311132045044262331122044466020321542566224360560525666622333211052565224306413534550454666514523310544156616321141363155444255330105351026251265504466662030136441443614364366051444444446122211552432214011025551406023455553060552625102041643406334164424166424314125124456503061225514522543503613355266602614111510532233326311504664522203325665120445411333215031220443510251110510556306666634555204444646023203621265504655033064534216414322664511051436261456445034401024233616652044336625130111254466622030105436656242215611264503333330150456542250310252241020462632266426051102433161406112351441655044623362343014665133123315516523203015144061660221653544162114333310524143426021105560566133334110550426021325554066022323660513544062442534204444342463430105322563012614435120313301445654423623353204450333116052450464566111354524413306135321131655443342125324012044462433361330155221554061120315034556144331605542132040112315533411020433453401635640140111056522042251116634161253113116054132260241551446552622362440155114540644165511353422460503260532656240132163435226311

table(seqz)
#   0   1   2   3   4   5   6 
# 123 172 157 170 179 164 154 

table(seqz[1:1118], seqz[2:1119])
#    0  1  2  3  4  5  6
# 0  0 21 19 20 23 25 15
# 1 22 39 21 24 26 17 22
# 2 23 19 29 18 22 24 22
# 3 18 22 25 48 22 17 18
# 4 18 23 21 26 49 24 18
# 5 20 27 21 18 19 36 23
# 6 22 20 21 16 18 21 36

seqz <- shuriken[cycle1[, 2]]
paste0(seqz, collapse='')
# 113503066023633365245616232241116401504236611150314541134406223135105554442266533425504066255211655560203102516615166022334236121022223011444520466311164156210232341204466503066221355514566425220350446622236423012646245301131050406021256553063560245503360553226636640115533063216335562115441462660231252166422263320352553326025211105214556630605641665222503344365354544102223015241660522032311551306412633313011154411665422244012111406656055110504222231221152434223605503346622463342105046102225633114444063320335563401660261115034366122463520350406622664530134136542503615554014644222261151511433660225533125350406263340112654556661024262035306662430612154454064653610235526641226633642255044065223311642046056222531315534415666133301654013066644534411561446602203141055153406632031354550406561165544443646432214515544366420446021610546126524115555453061162344254406102631130140116622350321204460512263231125554436204221022355041022250366343363065406536111324463355421240102605533246662332243555211564452203330160550462663524013511146465244333435541021353213011443062222203530643612203333551555646634155153146642436340
table(seqz)
#   0   1   2   3   4   5   6 
# 126 159 175 161 155 166 177
table(seqz[1:1118], seqz[2:1119])
#    0  1  2  3  4  5  6
# 0  0 20 23 22 18 16 26
# 1 19 43 19 18 16 25 19
# 2 18 22 55 23 19 18 20
# 3 23 19 16 35 20 25 23
# 4 24 19 21 16 35 16 24
# 5 22 14 20 22 23 46 19
# 6 20 21 21 25 24 20 46
